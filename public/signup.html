<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link
        href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Libre+Baskerville:wght@400;700&family=Oswald:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700;800;900&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300&family=Quicksand:wght@300;400;500;600&family=Sofia+Sans:wght@300;400;500;600;700&family=Source+Serif+Pro:wght@300;400;600;700;900&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css"
        integrity="sha512-MV7K8+y+gLIBoVD59lQIYicR65iaqukzvf/nwasF0nqhPay5w/9lJmVM2hMDcnK1OnMGCdVK+iQrJ7lzPJQd1w=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="stylesheet" href="styles.css">
    <title>Create a new account to our site</title>
</head>

<body>


    <nav class="navbar navbar-expand-lg navbar-dark ">
        <div class="container">
            <a class="navbar-brand headline" href="#">
                <h1>Next</h1>
                <h1>Dictionary</h1>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
                aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav me-auto mx-4 mb-2 mb-lg-0">
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" href="index.html" target="_blank">Home</a>
                    </li>

                    <li class="nav-item dropdown ">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button"
                            data-bs-toggle="dropdown" aria-expanded="false">
                            contact us
                        </a>
                        <ul class="dropdown-menu mn" aria-labelledby="navbarDropdown">
                            <li><a class="dropdown-item" href="#">Report errors</a></li>
                            <li><a class="dropdown-item" href="#">Suggest a word</a></li>
                            <li>
                                <hr class="dropdown-divider">
                            </li>
                            <li><a class="dropdown-item" href="#">Join our team</a></li>
                        </ul>
                    </li>

                </ul>
                <form class="d-flex srch">
                    <input class="form-control me-2 col-6 rounded-pill" type="search" placeholder="Search as guest"
                        aria-label="Search">
                    <button class="btn btn-warning rounded-pill" type="submit">Search</button>
                </form>
            </div>
        </div>
    </nav>
    <div class="cen container-fluid d-flex justify-content-center align-items-center">
        <main class="form-signin w-100 m-auto d-flex justify-content-center align-items-center">
            <form class=" d-flex flex-column justify-content-center align-items-center" id="formelem">
                <h1 class="h4 mb-3 fw-normal">Enter Credentials to Log in</h1>

                <div class="in container-fluid">

                    <div class="d-flex flex-row" style="gap: 1rem;">
                        <div class="form-floating col">
                            <input type="text" class="form-control mb-4 inp" id="floatingName" required
                                placeholder="name@example.com">
                            <label for="floatingName" class="text-dark">Full Name</label>
                        </div>
                        <div class="form-floating col">
                            <input type="text" class="form-control mb-4 inp" id="floatinguser" required
                                placeholder="Password">
                            <label for="floatinguser" class="text-dark">User Name</label>
                        </div>
                    </div>
                    <div class="form-floating ">
                        <input type="tel" class="form-control mb-4 inp" id="floatingph" required
                            placeholder="name@example.com">
                        <label for="floatingph" class="text-dark">Phone</label>
                    </div>
                    <div class="form-floating ">
                        <input type="email" class="form-control mb-4 inp" id="floatingInput" required
                            placeholder="name@example.com">
                        <label for="floatingInput" class="text-dark">Email address</label>
                    </div>
                    <div class="d-flex flex-row" style="gap: 1rem;">
                        <div class="form-floating col">
                            <input type="password" class="form-control mb-4 inp" id="floatingPassword" required
                                placeholder="name@example.com">
                            <label for="floatingPassword" class="text-dark">Password</label>
                        </div>
                        <div class="form-floating col">
                            <input type="password" class="form-control mb-4 inp" id="floatingPasswordc" required
                                placeholder="Password">
                            <label for="floatingPasswordc" class="text-dark">Confirm Password</label>
                        </div>
                        
                    </div>
                    <div class="form-floating">
                        <input type="file" class="form-control mb-4 inp" id="floatingPic" required
                            placeholder="Password" accept="image/*">
                        <label for="floatingPic" class="text-dark" style="font-size: 0.8rem;">Your Profile Picture</label>
                    </div>

                    <div class=" mb-3">
                        <label class="h5">
                            Already have an account? Click here to <a href="login.html" class="link-warning">Log
                                in</a>
                        </label>
                    </div>
                    <button class="w-100 btn btn-lg btn-primary submt" type="submit">Sign up</button>
                </div>
                <p class="my-3 text-muted">© 2017–2022</p>
            </form>
        </main>
    </div>



    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.17.2/firebase-app.js";
        import { getDatabase, ref as dbref, set } from "https://www.gstatic.com/firebasejs/9.17.2/firebase-database.js";
        import { getStorage, ref, uploadBytes } from "https://www.gstatic.com/firebasejs/9.17.2/firebase-storage.js";
        import { getAuth, signInWithEmailAndPassword, onAuthStateChanged, createUserWithEmailAndPassword, signOut } from "https://www.gstatic.com/firebasejs/9.17.2/firebase-auth.js";

        const firebaseConfig = {
            apiKey: "AIzaSyDuinZ2LIH8eXRUFHjdfJEXzm7oVQz7Ous",
            authDomain: "nextdictionary-47e38.firebaseapp.com",
            databaseURL: "https://nextdictionary-47e38-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "nextdictionary-47e38",
            storageBucket: "nextdictionary-47e38.appspot.com",
            messagingSenderId: "74714748153",
            appId: "1:74714748153:web:b0d3c1dfe0fe8d71a57e28"
        };
        const app = initializeApp(firebaseConfig);
        const auth = getAuth();
        const database = getDatabase(app);
        const storage = getStorage(app);
        onAuthStateChanged(auth, (user) => {
            if (user) {
                
                signOut(auth)
                    .then(() => {
                        alert("succesfully created account!")
                        location.replace("login.html");
                    })
                    .catch((error) => {
                        alert(error);
                    })
            }
        })
        var bookmarked =["Hello"];
        var hist =["Hello"];
        const fr = document.getElementById("formelem");
        fr.addEventListener("submit", (e) => {
            document.querySelector(".submt").classList.add("disabled");
            document.querySelector(".submt").innerHTML = "Signing up...";
            console.log(e);
            e.preventDefault();
            const fullName = document.getElementById("floatingName").value;
            const UserName = document.getElementById("floatinguser").value;
            const phone = document.getElementById("floatingph").value;
            const email = document.getElementById("floatingInput").value;
            var pword = "";
            if (document.getElementById("floatingPassword").value === document.getElementById("floatingPasswordc").value) {
                var pword = document.getElementById("floatingPassword").value;
            }
            else {
                alert("Password and confirm Password must be same");
                document.getElementById("floatingPassword").style.border = "2px solid red";
                document.getElementById("floatingPasswordc").style.border = "2px solid red";
                return false;
                document.querySelector(".submt").classList.remove("disabled");
                    document.querySelector(".submt").innerHTML = "Sign in";
            }
            const file = document.getElementById("floatingPic").files[0];
            createUserWithEmailAndPassword(auth, email, pword)
                .then((userCredential) => {
                    const user = userCredential.user;
                    const uid = user.uid;
                    console.log(user);
                    function writeUserData(fullName, UserName, email, phone, pword, bookm, hist) {
                        console.log(fullName + UserName + email + phone + pword);
                        set(dbref(database, 'accounts/' + uid), {
                            name: fullName,
                            username:UserName,
                            email: email,
                            phone: phone,
                            password: pword,
                            bookmarkedArray: bookm,
                            history:hist
                        });

                    }
                    writeUserData(fullName, UserName, email, phone, pword, bookmarked, hist);
                    const storageRef = ref(storage, email);
                    uploadBytes(storageRef, file).then((snapshot) => {
                        console.log('Uploaded file ' + snapshot);
                    });

                })
                .catch((error) => {
                    var errorCode = error.code;
                    var errorMessage = error.message;
                    alert("SignUp unSuccessful, error: " + errorMessage);
                    document.querySelector(".submt").classList.remove("disabled");
                    document.querySelector(".submt").innerHTML = "Sign in";
                });
        });

    </script>
    </script>
</body>

</html>